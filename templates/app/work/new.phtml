<?php $this->headTitle('New Work'); ?>
<?php //$this->layout()->instructions = "Never use double quotes in the title, instead use single quotes when needed."; ?>
<?php
/*use Zend\Session\Container;
$session = new \Zend\Session\Container('Bibliography');
	var_dump($session->id);
	var_dump($session->role);*/
	//echo $this->hasPermission();
	//$table = new \App\Db\Table\User($this->adapter);
	//$table->isAdmin();
?>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script>
$(document).ready(function () {
	$(".subject_tree").change(function()
	{
		var id=$(this).val();
		if(id != "") {
			var s1 = $('<select class="child_tree"/>');
			$.ajax({
				type: 'post',
				url: 'http://localhost<?=$this->url('manage_work')?>',
				data: {
					get_parent: id
				},
				//dataType: "json", 
             success: function(data) {
				if(data){
					for(i=0;i<data.length;i++){
						alert(data[i]);
					}
				}else{
					alert("error");
				}
				//$('<option />', {value: val, text: data1[val]}).appendTo(s1);
                //$('#'+list_target_id).html(output);
            },
			error: function (xhr, ajaxOptions, thrownError) {
            alert(xhr.status + " "+ thrownError);
			}});
		
			/*var data1 = {'City': 'New Delhi','City2': 'WDC','City3': 'Adilade','City4': 'Colombo'}; 
			var s1 = $('<select />');
			for(var val in data1)
			{
				$('<option />', {value: val, text: data1[val]}).appendTo(s1);
			} 
			s1.appendTo('#class_grp');*/
		}
	  //alert(id);
	  
	}
	);
     // Attach Button click event listener 
    $("#pubLookupBtn").click(function(){

         // show Modal
         $('#pubLookup').modal('show');
		 return false;
    });
});
</script>
<div class="col-md-7">
    <form id="personal-data" class="form-horizontal" method="POST" action="#">

<div class="tabbable">
  <ul class="nav nav-tabs">
    <li class="active">
      <a href="#General" data-toggle="tab">General</a>
    </li>
    <li>
      <a href="#Classification" data-toggle="tab">Classification</a>
    </li>  
	<li>
      <a href="#Publisher" data-toggle="tab">Publisher</a>
    </li>
	<li>
      <a href="#Agents" data-toggle="tab">Agents</a>
    </li>
	<li>
      <a href="#Citation" data-toggle="tab">Citation</a>
    </li>
  </ul>
  <div class="tab-content">
    <div class="tab-pane active" id="General">      
		<div class="form-group">
			<label class="col-xs-2 control-label">Title: </label>
			<div class="col-xs-10">
				<input type="text" class="form-control" name="new_worktitle" id="newworktitle" />
			</div>
		</div>
		<div class="form-group">
			<label class="col-xs-2 control-label">Sub Title: </label>
			<div class="col-xs-10">
				<input type="text" class="form-control" name="new_worksubtitle" id="newworksubtitle" />
			</div>
		</div>
		<div class="form-group">
			<label class="col-xs-2 control-label">Parallel Title: </label>
			<div class="col-xs-10">
				<input type="text" class="form-control" name="new_workparalleltitle" id="newworkparalleltitle" />
			</div>
		</div>
		<div class="form-group">
			<label class="col-xs-2 control-label">Description: </label>
			<div class="col-xs-10">
				<textarea class="form-control" placeholder="Message"></textarea>
			</div>
		</div>
		<div class="form-group">
			<label class="col-xs-2 control-label">Type: </label>
			<div class="col-xs-10">
				<select class="form-control" name="parent_id">
				<option value="">Type</option>					
				<?php
					//fetch worktypes
					$table = new \App\Db\Table\WorkType($this->adapter);
					$paginator = $table->fetchAllWorkTypes();
					foreach($paginator as $row) :
				?>
				<option value="<?=$row['id']?>"><?php echo $row['type']; ?></option>							
				<?php endforeach; ?>
				</select>
			</div>
		</div>
		<div class="form-group">
			<label class="col-xs-2 control-label">Parent Work: </label>
			<div class="col-xs-10">
				<button type="submit" class="btn btn-default" name="lookup_parent" value="parent_lookup">Lookup</button>
			</div>
		</div>		
		<div class="form-group">
			<label class="col-xs-2 control-label">Status: </label>
			<div class="col-xs-10">
				<div class="radio">
					<label class="radio"><input type="radio" id="selectworkstatus" name="select_workstatus" value="00">In Progress</label>
					<label class="radio"><input type="radio" id="selectworkstatus" name="select_workstatus" value="0">Pending Review</label>
					<label class="radio"><input type="radio" id="selectworkstatus" name="select_workstatus" value="2">Unseen Source Doc</label>
					<label class="radio"><input type="radio" id="selectworkstatus" name="select_workstatus" value="1">Complete</label>
				</div>
			</div>
		</div>		 
    </div>
    <div class="tab-pane" id="Classification">
		<div class="form-group" id="class_grp">
			<label class="col-xs-2 control-label">Subject Tree: </label>
			<div class="col-xs-5">
				<select class="form-control subject_tree" name="subject_tree">
				<option value=""></option>
				<?php
					//fetch worktypes
					$table = new \App\Db\Table\Folder($this->adapter);
					$paginator = $table->findParent();
					foreach($paginator as $row) :
				?>
				<option value="<?=$row['id']?>"><?php echo $row['text_fr']; ?></option>							
				<?php endforeach; ?>
				</select>
			</div>
		</div>		
    </div>  
	<div class="tab-pane" id="Publisher">
		<div class="form-group">
		<table class="table table-striped table-condensed" style="font-size:10pt;">
        <thead>
          <th>Lookup</th>
          <th>Year From</th>
          <th>Year To</th>
          <th>Publisher</th>
          <th>Location</th>
          <th>Remove</th>
		</thead>
		<tbody>
		<tr>
			<td><button class="btn btn-default" id="pubLookupBtn" data-toggle="modal" data-target="#pubLookup">Lookup</button></td>
			<td><input type="text" class="form-control" name="pub_yrFrom" id="pubyrFrom" /></td>
			<td><input type="text" class="form-control" name="pub_yrTo" id="pubyrTo" /></td>
			<td><input type="text" class="form-control" name="pub_name" id="pubName" /></td>
			<td><input type="text" class="form-control" name="pub_location" id="pubLocation" /></td>
			<td><button type="submit" class="btn btn-default" name="pub_remove" value="Remove">Remove</button></td>
		</tr>
		</tbody>
		</table>
		<button type="submit" class="btn btn-default" name="pub_add" value="Add">Add</button> 
		</div>
		<!-- Publisher Lookup -->
		<div id="pubLookup" class="modal fade" role="dialog">
		<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title" id="myModalLabel">Modal title</h4>
			</div>
			<div class="modal-body">
				<p>Hellooo</p>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary">Save changes</button>
			</div>
		</div>
		</div>
		</div>
	</div>
	<div class="tab-pane" id="Agents">
		<div class="form-group">
		<table class="table table-striped table-condensed" style="font-size:10pt;">
        <thead>
          <th>Lookup</th>
          <th>Agent Type</th>
          <th>First Name</th>
          <th>Last Name</th>
          <th>Alternate Name</th>
		  <th>Organization Name</th>
          <th>Remove</th>
		</thead>
		<tbody>
		<tr>
			<td><button class="btn btn-default" id="agentLookupBtn" data-toggle="modal" data-target="#agentLookup">Lookup</button></td>
			<td>
				<select class="form-control" name="agent_type" class="agent_type">
				<option value=""></option>
				<?php
					//fetch agenttypes
					$table = new \App\Db\Table\AgentType($this->adapter);
					$paginator = $table->fetchAgentTypes();
					foreach($paginator as $row) :
				?>
				<option value="<?=$row['id']?>"><?php echo $row['type']; ?></option>						
				<?php endforeach; ?>
				</select>
			</td>
			<td><input type="text" class="form-control" name="agent_FirstName" id="agent_FirstName" /></td>
			<td><input type="text" class="form-control" name="agent_LastName" id="agent_LastName" /></td>
			<td><input type="text" class="form-control" name="agent_AlternateName" id="agent_AlternateName" /></td>
			<td><input type="text" class="form-control" name="agent_OrganizationName" id="agentOrganizationName" /></td>
			<td><button type="submit" class="btn btn-default" name="agent_remove" value="Remove">Remove</button></td>
		</tr>
		</tbody>
		</table>
		<button type="submit" class="btn btn-default" name="agent_add" value="Add">Add</button> 
		</div>
		<!-- Agent Lookup -->
		<div class="modal fade" id="agentLookup" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		<div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel">Modal title</h4>
            </div>
            <div class="modal-body">
                ...
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Save changes</button>
            </div>
        </div>
		</div>
		</div>
	</div>
	<div class="tab-pane" id="Citation">
	</div>
  </div>
</div>
<div class="form-group">
	<div class="col-sm-offset-2 col-sm-10">
		<button type="submit" class="btn btn-default" name="submit_save" value="Save">Save</button> 
        <button type="submit" class="btn btn-default" name="submit_cancel" value="Cancel">Cancel</button>
	</div>
  </div>
</form>
</div>